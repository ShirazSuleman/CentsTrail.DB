SET ANSI_NULLS ON;
SET QUOTED_IDENTIFIER ON;
GO

IF NOT EXISTS (
			  SELECT 1 
			  FROM sys.tables 
			  WHERE name = 'UserCategory'
		  )
BEGIN
	CREATE TABLE [dbo].[UserCategory]
	(
		[UserCategoryID] BIGINT IDENTITY(1, 1) NOT NULL,
		[Name] NVARCHAR(256) NOT NULL,
		[UserID] NVARCHAR(128) NOT NULL,
		[Limit] DECIMAL(15, 2),
		[TransactionTypeID] INT NOT NULL,
		[DateAdded] DATETIME NOT NULL CONSTRAINT [df_UserCategory_DateAdded] DEFAULT (GETUTCDATE())

		CONSTRAINT [pk_UserCategory_UserCategoryID_UserID] PRIMARY KEY CLUSTERED (UserCategoryID ASC, UserID ASC),
		CONSTRAINT [uq_UserCategory_Name_UserID] UNIQUE (Name, UserID),
		CONSTRAINT [fk_UserCategory_UserID] FOREIGN KEY (UserID) REFERENCES [dbo].[User] (Id),
		CONSTRAINT [fk_UserCategory_TransactionTypeID] FOREIGN KEY (TransactionTypeID) REFERENCES [dbo].[TransactionType] (TransactionTypeID)
	);
END;
GO